# [0065. æŸ¥çœ‹ç›®å½•æˆ–æ–‡ä»¶ä¿¡æ¯](https://github.com/tnotesjs/TNotes.nodejs/tree/main/notes/0065.%20%E6%9F%A5%E7%9C%8B%E7%9B%AE%E5%BD%95%E6%88%96%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF)

<!-- region:toc -->

- [1. ğŸ“ æ¦‚è¿°](#1--æ¦‚è¿°)
- [2. ğŸ” `fs.Stats` å¯¹è±¡æˆå‘˜](#2--fsstats-å¯¹è±¡æˆå‘˜)
- [3. ğŸ’» demos.1 - æŸ¥çœ‹ç›®å½•æˆ–æ–‡ä»¶ä¿¡æ¯ `stat`](#3--demos1---æŸ¥çœ‹ç›®å½•æˆ–æ–‡ä»¶ä¿¡æ¯-stat)
- [4. ğŸ’» demos.2 - æ£€æŸ¥æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•](#4--demos2---æ£€æŸ¥æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•)

<!-- endregion:toc -->

## 1. ğŸ“ æ¦‚è¿°

- **å¼‚æ­¥æ–¹æ³•**ï¼š`fs.stat(path, callback)`ã€‚
- **åŒæ­¥æ–¹æ³•**ï¼š`fs.statSync(path)`ã€‚
- **è¿”å›å€¼**ï¼šè¿”å›ä¸€ä¸ª `fs.Stats` å¯¹è±¡ï¼ŒåŒ…å«æ–‡ä»¶æˆ–ç›®å½•çš„è¯¦ç»†ä¿¡æ¯ã€‚
  - `isFile()`ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶ã€‚
  - `isDirectory()`ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºç›®å½•ã€‚
  - `size`ï¼šæ–‡ä»¶çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚
  - `mtime`ï¼šæœ€åä¿®æ”¹æ—¶é—´ã€‚
  - `ctime`ï¼šåˆ›å»ºæ—¶é—´æˆ–å…ƒæ•°æ®æ›´æ”¹æ—¶é—´ã€‚
  - `birthtime`ï¼šæ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ï¼ˆä»…åœ¨æŸäº›æ“ä½œç³»ç»Ÿä¸Šæ”¯æŒï¼‰ã€‚
  - â€¦â€¦
- **è·¨å¹³å°å…¼å®¹æ€§**ï¼š
  - æ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ï¼ˆ`birthtime`ï¼‰åœ¨æŸäº›æ“ä½œç³»ç»Ÿï¼ˆå¦‚ Windowsï¼‰ä¸Šæ”¯æŒï¼Œä½†åœ¨ Linux ä¸Šå¯èƒ½ä¸å¯ç”¨ã€‚
- **ç¬¦å·é“¾æ¥**ï¼š
  - å¦‚æœè·¯å¾„æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œ`fs.stat()` ä¼šè§£æç¬¦å·é“¾æ¥å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ä¿¡æ¯ã€‚
  - å¦‚æœéœ€è¦ç›´æ¥è·å–ç¬¦å·é“¾æ¥æœ¬èº«çš„ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ `fs.lstat()` æˆ– `fs.lstatSync()`ã€‚
- **ENOENT é”™è¯¯**ï¼š
  - å¦‚æœä¼ å…¥çš„è·¯å¾„ä¸å­˜åœ¨ï¼Œåˆ™ä¼šæŠ¥é”™ `ENOENT`ã€‚

## 2. ğŸ” `fs.Stats` å¯¹è±¡æˆå‘˜

| æˆå‘˜å±æ€§      | è¯´æ˜                                                     |
| ------------- | -------------------------------------------------------- |
| `atime`       | è¡¨ç¤ºä¸Šæ¬¡è®¿é—®æ–‡ä»¶æˆ–ç›®å½•çš„æ—¶é—´æˆ³                           |
| `atimeMs`     | è¡¨ç¤ºæœ€åä¸€æ¬¡è®¿é—®æ–‡ä»¶æˆ–ç›®å½•æ—¶çš„æ—¶é—´æˆ³ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰     |
| `birthtime`   | è¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•åˆ›å»ºæ—¶çš„æ—¶é—´æˆ³                             |
| `birthtimeMs` | è¡¨ç¤ºåˆ›å»ºæ–‡ä»¶æˆ–ç›®å½•æ—¶çš„æ—¶é—´æˆ³ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰             |
| `blksize`     | è¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•ä¸­ I/O æ“ä½œçš„å—å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰        |
| `blocks`      | è¡¨ç¤ºåˆ†é…ç»™æ–‡ä»¶æˆ–ç›®å½•çš„å—æ•°                               |
| `ctime`       | è¡¨ç¤ºä¸Šæ¬¡æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çŠ¶æ€æ—¶çš„æ—¶é—´æˆ³                     |
| `ctimeMS`     | è¡¨ç¤ºæœ€åä¸€æ¬¡æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çŠ¶æ€æ—¶çš„æ—¶é—´æˆ³ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ |
| `dev`         | è¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•æ‰€åœ¨çš„è®¾å¤‡ ID                              |
| `gid`         | è¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•æ‰€å±ç»„çš„æ•°å­—æ ‡è¯†                           |
| `ino`         | è¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„ç´¢å¼•ç¼–å·                                 |
| `mode`        | è¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„æƒé™                                     |
| `mtime`       | è¡¨ç¤ºä¸Šæ¬¡ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•æ—¶çš„æ—¶é—´æˆ³                         |
| `mtimeMs`     | è¡¨ç¤ºæœ€åä¸€æ¬¡ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•æ—¶çš„æ—¶é—´æˆ³ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰     |
| `nlink`       | è¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„ç¡¬é“¾æ¥æ•°é‡                               |
| `rdev`        | è¡¨ç¤ºå­—ç¬¦è®¾å¤‡æ–‡ä»¶æˆ–å—è®¾å¤‡æ–‡ä»¶æ‰€åœ¨çš„è®¾å¤‡ ID                |
| `size`        | è¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„å¤§å°ï¼ˆå³æ–‡ä»¶ä¸­çš„å­—èŠ‚æ•°ï¼‰                 |
| `uid`         | è¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…çš„ç”¨æˆ· ID                          |

| æˆå‘˜æ–¹æ³•              | è¯´æ˜                     |
| --------------------- | ------------------------ |
| `isBlockDevice()`     | åˆ¤æ–­æ˜¯å¦æ˜¯å—è®¾å¤‡         |
| `isCharacterDevice()` | åˆ¤æ–­æ˜¯å¦æ˜¯å­—ç¬¦è®¾å¤‡       |
| `isDirectory()`       | åˆ¤æ–­æ˜¯å¦æ˜¯ç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰ |
| `isFIFO()`            | åˆ¤æ–­æ˜¯å¦æ˜¯ FIFO å­˜å‚¨å™¨   |
| `isFile()`            | åˆ¤æ–­æ˜¯å¦æ˜¯æ–‡ä»¶           |
| `isSocket()`          | åˆ¤æ–­æ˜¯å¦æ˜¯ socket åè®®   |

## 3. ğŸ’» demos.1 - æŸ¥çœ‹ç›®å½•æˆ–æ–‡ä»¶ä¿¡æ¯ `stat`

::: code-group

```js [1.cjs] {7}
const fs = require('fs')
const path = require('path')

const filePath = path.join(__dirname, '1.txt')

try {
  const stats = fs.statSync(filePath)
  // è¾“å‡ºæ–‡ä»¶æˆ–ç›®å½•çš„çŠ¶æ€ä¿¡æ¯
  console.log(`è·¯å¾„: ${filePath}`)
  console.log(`æ˜¯å¦ä¸ºæ–‡ä»¶: ${stats.isFile()}`)
  console.log(`æ˜¯å¦ä¸ºç›®å½•: ${stats.isDirectory()}`)
  console.log(`æ–‡ä»¶å¤§å°: ${stats.size} å­—èŠ‚`)
  console.log(`æ–‡ä»¶åˆ›å»ºæ—¶é—´: ${stats.birthtime}`)
  console.log(`æœ€åä¿®æ”¹æ—¶é—´: ${stats.mtime}`)
} catch (err) {
  if (err) {
    if (err.code === 'ENOENT') {
      console.error(`è·¯å¾„ä¸å­˜åœ¨: ${filePath}`)
    } else {
      console.error(`è·å–çŠ¶æ€æ—¶å‡ºé”™: ${err.message}`)
    }
    return
  }
}

// è¾“å‡ºï¼š
// è·¯å¾„: /Users/huyouda/zm/notes/TNotes.nodejs/notes/0065. æŸ¥çœ‹ç›®å½•æˆ–æ–‡ä»¶ä¿¡æ¯/demos/1/1.txt
// æ˜¯å¦ä¸ºæ–‡ä»¶: true
// æ˜¯å¦ä¸ºç›®å½•: false
// æ–‡ä»¶å¤§å°: 5 å­—èŠ‚
// æ–‡ä»¶åˆ›å»ºæ—¶é—´: Sat Apr 19 2025 19:10:36 GMT+0800 (China Standard Time)
// æœ€åä¿®æ”¹æ—¶é—´: Sat Apr 19 2025 19:10:38 GMT+0800 (China Standard Time)

// fs.statSync çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª fs.Stats å¯¹è±¡ã€‚
// fs.Stats å¯¹è±¡æä¾›äº†å¾ˆå¤šå±æ€§å’Œæ–¹æ³•ï¼Œç”¨äºè·å–æ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯ã€‚
```

```js [1.txt]
test
```

:::

## 4. ğŸ’» demos.2 - æ£€æŸ¥æ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•

::: code-group

```js [1.cjs] {11}
const fs = require('fs')
const path = require('path')

const filePath = path.join(__dirname, '1.txt')

checkIsFileOrDirectory(filePath)
// è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå¤§å°ä¸º 5 å­—èŠ‚ã€‚

function checkIsFileOrDirectory(filePath) {
  try {
    const stats = fs.statSync(filePath)

    if (stats.isFile()) {
      console.log(`è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå¤§å°ä¸º ${stats.size} å­—èŠ‚ã€‚`)
    } else if (stats.isDirectory()) {
      console.log(`è¿™æ˜¯ä¸€ä¸ªç›®å½•ï¼Œæœ€åä¿®æ”¹æ—¶é—´ä¸º ${stats.mtime}ã€‚`)
    }
  } catch (err) {
    switch (err.code) {
      case 'ENOENT':
        console.error(`è·¯å¾„ä¸å­˜åœ¨: ${filePath}`)
        break
      case 'EACCES':
        console.error(`æƒé™ä¸è¶³ï¼Œæ— æ³•è®¿é—®è·¯å¾„: ${filePath}`)
        break
      default:
        console.error(`å‘ç”ŸæœªçŸ¥é”™è¯¯: ${err.message}`)
    }
  }
}
```

```js [1.txt]
test
```

:::
