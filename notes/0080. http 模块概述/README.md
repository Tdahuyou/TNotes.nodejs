# [0080. http æ¨¡å—æ¦‚è¿°](https://github.com/Tdahuyou/TNotes.nodejs/tree/main/notes/0080.%20http%20%E6%A8%A1%E5%9D%97%E6%A6%82%E8%BF%B0)

<!-- region:toc -->

- [1. ğŸ“’ æ¦‚è¿°](#1--æ¦‚è¿°)
- [2. ğŸ’» demos.1 - `server` å¯¹è±¡](#2--demos1---server-å¯¹è±¡)
- [3. ğŸ’» demos.2 - `response` å¯¹è±¡](#3--demos2---response-å¯¹è±¡)
- [4. ğŸ’» demos.3 - å“åº” html æ–‡ä»¶](#4--demos3---å“åº”-html-æ–‡ä»¶)
- [5. ğŸ’» demos.4 - å“åº”åª’ä½“èµ„æº](#5--demos4---å“åº”åª’ä½“èµ„æº)
- [6. ğŸ’» demos.5 - é‡å®šå‘](#6--demos5---é‡å®šå‘)
- [7. ğŸ’» demos.6 - `request` å¯¹è±¡](#7--demos6---request-å¯¹è±¡)

<!-- endregion:toc -->

## 1. ğŸ“’ æ¦‚è¿°

- http æ¨¡å—ä¸­ä¸»è¦æœ‰ `server` å¯¹è±¡ã€`response` å¯¹è±¡å’Œ `request` å¯¹è±¡ï¼Œä¹Ÿæ˜¯æœ¬èŠ‚ç¬”è®°ä¸»è¦ä»‹ç»çš„å†…å®¹ã€‚

## 2. ğŸ’» demos.1 - `server` å¯¹è±¡

- `server` å¯¹è±¡ç”¨æ¥åˆ›å»ºä¸€ä¸ªæœåŠ¡ã€‚
- åœ¨ Node.js ä¸­ï¼Œä½¿ç”¨ `http` æ¨¡å—ä¸­çš„ `createServer()` æ–¹æ³•ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ª `server` å¯¹è±¡
  - `const server = require('http').createServer()`
- `server` å¯¹è±¡ä¸­ä¸»è¦ä½¿ç”¨çš„æ–¹æ³•æœ‰ `listen()` æ–¹æ³•å’Œ `close()` æ–¹æ³•ï¼Œå®ƒä»¬åˆ†åˆ«æ§åˆ¶ç€æœåŠ¡å™¨çš„å¯åŠ¨å’Œç»“æŸã€‚
  - `server.listen(port)` å¯åŠ¨æœåŠ¡å™¨ï¼Œå¹¶ç›‘å¬æŒ‡å®šç«¯å£ã€‚
    - ç«¯å£ `port` æ˜¯è®¡ç®—æœºä¸è®¡ç®—æœºä¹‹é—´ä¿¡æ¯çš„é€šé“ã€‚
    - è®¡ç®—æœºä¸­çš„ç«¯å£ä» `0` å¼€å§‹ï¼Œä¸€å…±æœ‰ `65535` ä¸ªç«¯å£ã€‚
  - `server.close()` å…³é—­æœåŠ¡å™¨ã€‚

::: code-group

<<< ./demos/1/1.cjs {js}

:::

- åœ¨æœåŠ¡å¯åŠ¨æœŸé—´è®¿é—®ï¼š`http://127.0.0.1:23523`
  - ![å›¾ 0](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-24-21-07-01.png)
- ä¸Šè¿°ç¨‹åºçš„å¤§è‡´æµç¨‹ï¼š
  - å¼•å…¥ `http` æ¨¡å—å¹¶åˆ›å»ºæœåŠ¡å™¨å¯¹è±¡ã€‚
  - æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œè®¾ç½®å“åº”å¤´ `Content-Type` ä¸º `text/plain; charset=utf-8`
    - `Content-Type` è®¾ç½®ä¸ºæ–‡æœ¬ç±»å‹
    - `text/plain` è®¾ç½®ä¸ºçº¯æ–‡æœ¬ç±»å‹
    - `charset=utf-8` è®¾ç½®ä¸º UTF-8 ç¼–ç ï¼Œä»¥é¿å…ä¹±ç ã€‚
  - `res.end('æœåŠ¡å™¨æ­£åœ¨è¿è¡Œä¸­...\n')`
    - å¹¶è¿”å›ä¸­æ–‡æ¶ˆæ¯ "æœåŠ¡å™¨æ­£åœ¨è¿è¡Œä¸­..."ã€‚
    - è¿™é‡Œçš„ `res` å…¶å®å°±æ˜¯ `response` å¯¹è±¡ã€‚
  - æœåŠ¡å™¨ç›‘å¬ç«¯å£ `23523`ï¼Œå¯åŠ¨åè¾“å‡ºç›‘å¬åœ°å€ã€‚
    - `we` çš„ç”Ÿæ—¥æ˜¯ `2023.05.23`
  - å¯åŠ¨å 10 ç§’è‡ªåŠ¨å…³é—­æœåŠ¡å™¨ã€‚
  - å…³é—­æœåŠ¡å™¨åè¾“å‡º "æœåŠ¡å™¨å·²æˆåŠŸå…³é—­"ã€‚

## 3. ğŸ’» demos.2 - `response` å¯¹è±¡

- `response` å¯¹è±¡ç”¨äºå‘å®¢æˆ·ç«¯å‘é€å“åº”ã€‚
- ä¸»è¦æ–¹æ³•ï¼š
  - `writeHead(statusCode [,statusMessage]â€‹ [,headers])`ï¼šè®¾ç½®å“åº”å¤´ã€‚
    - `statusCode`ï¼šæ•°å­—ç±»å‹çš„ HTTP çŠ¶æ€ç ã€‚
    - `statusMessage`ï¼šHTTP çŠ¶æ€ç å¯¹åº”çš„æ¶ˆæ¯ã€‚
    - `headers`ï¼šå“åº”å¤´å¯¹è±¡ã€‚
  - `end([data], [encoding])`ï¼šç»“æŸå“åº”å¹¶å‘é€æ•°æ®åˆ°å®¢æˆ·ç«¯ã€‚
    - `data`ï¼šå¯é€‰å‚æ•°ï¼Œæ‰§è¡Œå®Œæ¯•åè¦å‘é€çš„å­—ç¬¦ã€‚
    - `encoding`ï¼šå¯é€‰å‚æ•°ï¼Œæ•°æ®ç¼–ç æ ¼å¼ã€‚

::: code-group

<<< ./demos/2/1.cjs {js}

:::

- ![å›¾ 0](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-25-10-41-40.png)

## 4. ğŸ’» demos.3 - å“åº” html æ–‡ä»¶

::: code-group

<<< ./demos/3/1.cjs {js}

<<< ./demos/3/1.html {html}

:::

- ![å›¾ 1](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-25-11-00-09.png)

## 5. ğŸ’» demos.4 - å“åº”åª’ä½“èµ„æº

::: code-group

<<< ./demos/4/1.cjs {js}

:::

- æœ€ç»ˆæ•ˆæœï¼š
  - è®¿é—®ï¼šhttp://127.0.0.1:23523/image
    - ![å›¾ 1](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-26-06-54-02.png)
  - è®¿é—®ï¼šhttp://127.0.0.1:23523/video
    - ![å›¾ 2](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-26-07-04-25.png)
- å¤‡æ³¨ï¼š
  - å…¶ä¸­ `1.mp4` æ˜¯ `0032. ã€ŠNode.js ä»å…¥é—¨åˆ°ç²¾é€šã€‹` ä¸­çš„è§†é¢‘ `11.3 http æ¨¡å—.mp4` çš„å¼€å¤´éƒ¨åˆ†ã€‚

## 6. ğŸ’» demos.5 - é‡å®šå‘

::: code-group

<<< ./demos/5/1.cjs {js}

:::

- è®¿é—®ï¼šhttp://127.0.0.1:23523
  - ä¼šè‡ªåŠ¨è·³è½¬åˆ° https://tdahuyou.github.io/notes/
  - ![å›¾ 3](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-26-07-58-33.png)
- `writeHead` çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ `statusCode` çŠ¶æ€ç ï¼Œå…¶æ•°æ®ç±»å‹æ˜¯ `number`ã€‚
- **å¸¸è§çš„çŠ¶æ€ç åŠå…¶å«ä¹‰**ï¼š

| çŠ¶æ€ç  | è¯´æ˜         | ä¸¾ä¾‹                      |
| ------ | ------------ | ------------------------- |
| `1**`  | å¤„ç†ä¸­       | 100 Continue              |
| `2**`  | æˆåŠŸ         | 200 OK                    |
| `3**`  | é‡å®šå‘       | 302 Temporarily Moved     |
| `4**`  | å®¢æˆ·ç«¯é”™è¯¯   | 400 Bad Request           |
| `5**`  | æœåŠ¡å™¨ç«¯é”™è¯¯ | 500 Internal Server Error |

## 7. ğŸ’» demos.6 - `request` å¯¹è±¡

- `request` å¯¹è±¡ç”¨äºå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ã€‚
- ä¸»è¦å±æ€§ï¼š
  - `method`ï¼šè¯·æ±‚æ–¹æ³•ï¼ˆå¦‚ `GET`, `POST` ç­‰ï¼‰ã€‚
  - `url`ï¼šè¯·æ±‚çš„ URLã€‚
  - `headers`ï¼šè¯·æ±‚å¤´å¯¹è±¡ã€‚
- ä¸»è¦æ–¹æ³•ï¼š
  - `on(event, listener)`ï¼šç›‘å¬è¯·æ±‚äº‹ä»¶ã€‚
    - `event`ï¼šäº‹ä»¶åç§°ï¼Œæ¯”å¦‚ `data`ã€`end` ç­‰ã€‚
    - `listener`ï¼šäº‹ä»¶å¤„ç†å‡½æ•°ã€‚

::: code-group

<<< ./demos/6/1.cjs {js 11,16-27}

<<< ./demos/6/1.html {html}

:::

- æµ‹è¯•ï¼š
  - ç”¨æˆ·åï¼š`111`
  - å¯†ç ï¼š`222`
  - è®°ä½å¯†ç ï¼š`æ˜¯`
  - ![å›¾ 4](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-26-08-42-17.png)
  - ç‚¹å‡»ã€ç™»å½•ã€‘åï¼š
  - ![å›¾ 5](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-26-08-42-24.png)
