# [0074. ç®¡ç†è¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§](https://github.com/Tdahuyou/TNotes.nodejs/tree/main/notes/0074.%20%E7%AE%A1%E7%90%86%E8%BF%9B%E7%A8%8B%E7%9A%84%E8%B0%83%E5%BA%A6%E4%BC%98%E5%85%88%E7%BA%A7)

<!-- region:toc -->

- [1. ğŸ“’ æ¦‚è¿°](#1--æ¦‚è¿°)
- [2. ğŸ’» æŸ¥çœ‹ PID](#2--æŸ¥çœ‹-pid)
- [3. ğŸ’» demos.1 - è·å–å½“å‰è¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§](#3--demos1---è·å–å½“å‰è¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§)
- [4. ğŸ’» demos.2 - ä¿®æ”¹è¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§](#4--demos2---ä¿®æ”¹è¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§)
- [5. ğŸ’» demos.3 - æŸ¥çœ‹ç”µè„‘çš„ä¼˜å…ˆçº§å¸¸é‡](#5--demos3---æŸ¥çœ‹ç”µè„‘çš„ä¼˜å…ˆçº§å¸¸é‡)
- [6. ğŸ”— References](#6--references)

<!-- endregion:toc -->

## 1. ğŸ“’ æ¦‚è¿°

- ä» Node.js v12.16.0 å¼€å§‹ï¼Œ`os` æ¨¡å—å¼•å…¥äº† `getPriority()` å’Œ `setPriority()` æ–¹æ³•ï¼Œç”¨äºè·å–å’Œè®¾ç½®è¿›ç¨‹æˆ–çº¿ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§ã€‚
- `os.getPriority([pid])`
  - ç”¨äºè·å–æŒ‡å®šè¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§ã€‚
  - **å‚æ•°**ï¼š
    - `pid`ï¼ˆå¯é€‰ï¼‰ï¼šç›®æ ‡è¿›ç¨‹çš„ IDï¼ˆProcess IDï¼‰ã€‚
    - ä¼ å…¥æŒ‡å®šè¿›ç¨‹çš„ PIDï¼Œå¯è·å–æŒ‡å®šè¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§ã€‚
    - å¦‚æœæœªæä¾›å‚æ•°æˆ–è€…ä¼ å…¥ `0`ï¼Œé»˜è®¤è¿”å›å½“å‰è¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚
  - **è¿”å›å€¼**ï¼š
    - è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºç›®æ ‡è¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§ã€‚
    - å…·ä½“èŒƒå›´å–å†³äºæ“ä½œç³»ç»Ÿï¼š
      - åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œä¼˜å…ˆçº§èŒƒå›´é€šå¸¸æ˜¯ `-20` åˆ° `19`ï¼Œæ•°å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ã€‚
      - åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œä¼˜å…ˆçº§èŒƒå›´å¯èƒ½ä¸åŒï¼Œå…·ä½“è¡Œä¸ºä¾èµ–äºç³»ç»Ÿå®ç°ã€‚
  - **æŠ¥é”™**ï¼š
    - å¦‚æœæä¾›çš„ `pid` æ— æ•ˆï¼ˆä¾‹å¦‚ç›®æ ‡è¿›ç¨‹ä¸å­˜åœ¨ï¼‰ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚
- `os.setPriority(pid, priority)`
  - ç”¨äºè®¾ç½®æŒ‡å®šè¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§ã€‚
  - å®ƒå…è®¸å¼€å‘è€…åŠ¨æ€è°ƒæ•´ä¼˜å…ˆçº§ä»¥ä¼˜åŒ–ç³»ç»Ÿèµ„æºåˆ†é…ã€‚
  - **å‚æ•°**ï¼š
    - `pid`ï¼š
      - ç›®æ ‡è¿›ç¨‹çš„ IDï¼ˆProcess IDï¼‰ã€‚
      - å¯ä»¥æ˜¯å½“å‰è¿›ç¨‹æˆ–å…¶ä»–è¿›ç¨‹çš„ PIDã€‚
      - å¦‚æœæœªæä¾›å‚æ•°æˆ–è€…ä¼ å…¥ `0` è¡¨ç¤ºè®¾ç½®å½“å‰è¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚
    - `priority`ï¼š
      - æ–°çš„ä¼˜å…ˆçº§å€¼ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚
      - å…·ä½“èŒƒå›´å–å†³äºæ“ä½œç³»ç»Ÿã€‚
  - **å¼‚å¸¸**ï¼š
    - å¦‚æœ `pid` æ— æ•ˆï¼ˆä¾‹å¦‚ç›®æ ‡è¿›ç¨‹ä¸å­˜åœ¨ï¼‰ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚
    - å¦‚æœ `priority` è¶…å‡ºäº†ç³»ç»Ÿå…è®¸çš„èŒƒå›´ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚
    - åœ¨æŸäº›æ“ä½œç³»ç»Ÿä¸Šï¼Œä¿®æ”¹å…¶ä»–è¿›ç¨‹çš„ä¼˜å…ˆçº§å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚
- **æ³¨æ„äº‹é¡¹**:
  - **å¹³å°å·®å¼‚**ï¼š
    - åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œä¼˜å…ˆçº§èŒƒå›´é€šå¸¸æ˜¯ `-20` åˆ° `19`ï¼Œæ•°å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ã€‚
    - åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œä¼˜å…ˆçº§èŒƒå›´å’Œè¡Œä¸ºå¯èƒ½ä¸åŒï¼Œå…·ä½“å–å†³äºæ“ä½œç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦æœºåˆ¶ã€‚
  - **æƒé™é™åˆ¶**ï¼š
    - ä¿®æ”¹å…¶ä»–è¿›ç¨‹çš„ä¼˜å…ˆçº§é€šå¸¸éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚
    - å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„æƒé™ï¼Œè°ƒç”¨ `setPriority()` ä¼šæŠ›å‡ºé”™è¯¯ã€‚
  - **å®éªŒæ€§ç‰¹æ€§**ï¼š
    - è¿™äº›æ–¹æ³•è™½ç„¶å·²ç»ç¨³å®šï¼Œä½†åœ¨æŸäº›åœºæ™¯ä¸‹ä»å¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚
    - å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å‰è¿›è¡Œå……åˆ†æµ‹è¯•ã€‚
  - **æ½œåœ¨é£é™©**ï¼š
    - ä¸æ°å½“çš„ä¼˜å…ˆçº§è®¾ç½®å¯èƒ½å¯¼è‡´ç³»ç»Ÿèµ„æºåˆ†é…ä¸å‡ï¼Œç”šè‡³å¼•å‘æ€§èƒ½é—®é¢˜æˆ–æ­»é”ã€‚åº”è°¨æ…ä½¿ç”¨ã€‚
- **ä½¿ç”¨å»ºè®®**ï¼š
  - å¦‚æœæ‚¨çš„åº”ç”¨è¿è¡Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç›´æ¥ä¿®æ”¹è¿›ç¨‹ä¼˜å…ˆçº§å¯èƒ½ä¼šå¼•å‘æ„å¤–é—®é¢˜ï¼ˆå¦‚èµ„æºç«äº‰ã€æ­»é”ç­‰ï¼‰ã€‚
  - å»ºè®®ä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨ï¼Œå¹¶ç¡®ä¿ç»è¿‡å……åˆ†æµ‹è¯•ã€‚
  - **é¿å…ç›´æ¥ä¿®æ”¹ç³»ç»Ÿçº§ä¼˜å…ˆçº§**
    - æˆ–è®¸æ‚¨å¯ä»¥ä¸ç”¨ä¿®æ”¹è¿›ç¨‹ä¼˜å…ˆçº§ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¯èƒ½çš„æ›¿ä»£æ–¹æ¡ˆï¼š
    - **ä¼˜åŒ–ä»£ç é€»è¾‘**ï¼šé€šè¿‡å‡å°‘é˜»å¡æ“ä½œã€åˆç†åˆ†é…ä»»åŠ¡ç­‰æ–¹å¼æé«˜æ€§èƒ½ã€‚
    - **ä½¿ç”¨å¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹**ï¼šåˆ©ç”¨ `worker_threads` æˆ– `child_process` æ¨¡å—åˆ†æ‹…ä»»åŠ¡å‹åŠ›ã€‚
- **åº”ç”¨åœºæ™¯**ï¼š
  - **å®æ—¶åº”ç”¨**ï¼šå¯¹äºéœ€è¦å¿«é€Ÿå“åº”çš„ä»»åŠ¡ï¼ˆå¦‚éŸ³è§†é¢‘å¤„ç†ã€æ¸¸æˆå¼•æ“ï¼‰ï¼Œå¯ä»¥é€šè¿‡æé«˜çº¿ç¨‹æˆ–è¿›ç¨‹ä¼˜å…ˆçº§æ¥å‡å°‘å»¶è¿Ÿã€‚
  - **åå°ä»»åŠ¡**ï¼šå¯¹äºéå…³é”®ä»»åŠ¡ï¼ˆå¦‚æ—¥å¿—è®°å½•ã€æ•°æ®å¤‡ä»½ï¼‰ï¼Œå¯ä»¥é™ä½å…¶ä¼˜å…ˆçº§ä»¥é¿å…æŠ¢å é‡è¦èµ„æºã€‚
  - **å¤šè¿›ç¨‹ä¼˜åŒ–**ï¼šåœ¨ä½¿ç”¨ `child_process` æˆ–å…¶ä»–å¤šè¿›ç¨‹ç¼–ç¨‹åœºæ™¯ä¸­ï¼Œé€šè¿‡åŠ¨æ€è°ƒæ•´è¿›ç¨‹ä¼˜å…ˆçº§æ¥å¹³è¡¡æ€§èƒ½ã€‚

## 2. ğŸ’» æŸ¥çœ‹ PID

- å¦‚æœä½ æ˜¯ macOS ç”¨æˆ·ï¼Œå¯ä»¥ç›´æ¥åœ¨ã€æ´»åŠ¨ç›‘è§†å™¨ã€‘é¢æ¿ä¸­æŸ¥çœ‹è¿›ç¨‹çš„ PIDã€‚
  - ![å›¾ 0](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-20-07-37-48.png)
- å¦‚æœä½ æ˜¯ Windows ç”¨æˆ·ï¼Œå¯ä»¥ç›´æ¥åœ¨ã€ä»»åŠ¡ç®¡ç†å™¨ã€‘ä¸­æŸ¥çœ‹è¿›ç¨‹çš„ PIDã€‚
  - ![å›¾ 1](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-20-07-39-27.png)
- ã€ç¤ºä¾‹ã€‘ä¿®æ”¹ chrome.exe çš„ä¼˜å…ˆçº§
  - ä¿®æ”¹ä¹‹å‰çš„åŸä¼˜å…ˆçº§ï¼š
  - ![å›¾ 2](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-20-08-10-36.png)

```js
const os = require('os')
os.getPriority(10904) // => 19
os.setPriority(10904, 10) // [!code highlight]
```

- æ‰§è¡Œ `os.setPriority(10904, 10)` è¡¨ç¤ºå°† chrome.exeï¼ˆPID ä¸º 10904ï¼‰çš„çš„ä¼˜å…ˆçº§è®¾ç½®ä¸º 10ï¼Œæœ€ç»ˆä¼šå¯¼è‡´å®ƒçš„åŸºæœ¬ä¼˜å…ˆçº§å˜ä½ã€‚
- ä¿®æ”¹ä¹‹åçš„æ–°ä¼˜å…ˆçº§ï¼š
  - ![å›¾ 3](https://cdn.jsdelivr.net/gh/Tdahuyou/imgs@main/2025-04-20-08-11-55.png)

## 3. ğŸ’» demos.1 - è·å–å½“å‰è¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§

::: code-group

<<< ./demos/1/1.cjs {js 4-5}

:::

## 4. ğŸ’» demos.2 - ä¿®æ”¹è¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§

::: code-group

<<< ./demos/2/1.cjs {js 5}

<<< ./demos/2/2.cjs {js 5-6}

<<< ./demos/2/3.cjs {js 5}

<<< ./demos/2/4.cjs {js 3-16}

:::

## 5. ğŸ’» demos.3 - æŸ¥çœ‹ç”µè„‘çš„ä¼˜å…ˆçº§å¸¸é‡

::: code-group

<<< ./demos/3/1.cjs {js 2}

:::

| å¸¸é‡åç§°                | æ•°å€¼  | å«ä¹‰                                     |
| ----------------------- | ----- | ---------------------------------------- |
| `PRIORITY_LOW`          | `19`  | ä½ä¼˜å…ˆçº§ã€‚                               |
| `PRIORITY_BELOW_NORMAL` | `10`  | ä¼˜å…ˆçº§åˆ«æ¯”ä½ä¼˜å…ˆçº§é«˜ï¼Œä½†æ¯”æ­£å¸¸ä¼˜å…ˆçº§ä½ã€‚ |
| `PRIORITY_NORMAL`       | `0`   | æ­£å¸¸ä¼˜å…ˆçº§ã€‚                             |
| `PRIORITY_ABOVE_NORMAL` | `-7`  | ä¼˜å…ˆçº§åˆ«æ¯”é«˜ä¼˜å…ˆçº§ä½ï¼Œä½†æ¯”æ­£å¸¸ä¼˜å…ˆçº§é«˜ã€‚ |
| `PRIORITY_HIGH`         | `-14` | é«˜ä¼˜å…ˆçº§ã€‚                               |
| `PRIORITY_HIGHEST`      | `-20` | æœ€é«˜ä¼˜å…ˆçº§ã€‚                             |

- åœ¨ä½¿ç”¨ `os` æ¨¡å—çš„ `setPriority()` æ–¹æ³•è®¾ç½®è¿›ç¨‹ä¼˜å…ˆçº§æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†å…¶ `priority` å‚æ•°è®¾ç½®ä¸ºä»¥ä¸Š 6 ä¸ªå€¼ä¹‹ä¸€ã€‚

## 6. ğŸ”— References

::: details

- [priority](https://github.com/Tdahuyou/TNotes.en-words/blob/main/priority.md)
  - ä¼˜å…ˆçº§
  - ä¼˜å…ˆæƒ

:::
